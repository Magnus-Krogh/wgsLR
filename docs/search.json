[{"path":"/articles/introduction.html","id":"estimating-the-genotype-error-probability-w","dir":"Articles","previous_headings":"","what":"Estimating the genotype error probability, \\(w\\)","title":"Introduction","text":"simple example:","code":"cases <- wgsLR::sample_data_Hp(n = 1000, w = 0.1, p = c(0.25, 0.25, 0.5)) tab <- table(cases$X_D, cases$X_S) tab #>     #>       0   1   2 #>   0 229  74   8 #>   1  67 118  82 #>   2   9  77 336"},{"path":"/articles/introduction.html","id":"maximum-likelihood-estimation","dir":"Articles","previous_headings":"Estimating the genotype error probability, \\(w\\)","what":"Maximum likelihood estimation","title":"Introduction","text":"","code":"w_mle <- wgsLR::estimate_w(tab) w_mle #> [1] 0.1024541 w_mle_se <- wgsLR::estimate_w_se(tab, w_mle) w_mle_se #> [1] 0.006167563"},{"path":"/articles/introduction.html","id":"bayesian-inference","dir":"Articles","previous_headings":"Estimating the genotype error probability, \\(w\\)","what":"Bayesian inference","title":"Introduction","text":"package contains simple Metropolis-Hastings sampler (also see “Using Stan Bayesian inference” vignette):","code":"w_b <- wgsLR::estimate_w_bayesian(tab) |> lapply(\\(x) x$samples) |> unlist() w_b_q <- quantile(w_b, c(0.025, 0.975)) hist(w_b, main = NULL, xlab = expression(hat(w))) abline(v = mean(w_b), col = \"deeppink3\", lwd = 3) abline(v = w_b_q[1], col = \"deeppink3\"); abline(v = w_b_q[2], col = \"deeppink3\") abline(v = w_mle, col = \"yellow3\", lwd = 3) abline(v = w_mle - 2*w_mle_se, col = \"yellow3\"); abline(v = w_mle + 2*w_mle_se, col = \"yellow3\") legend(\"topright\", col = c(\"deeppink3\", \"yellow3\"), legend = c(\"Bayesian\", \"MLE\"), lty = 1, lwd = 2)"},{"path":"/articles/introduction.html","id":"calculating-likelihood-ratios-lrs","dir":"Articles","previous_headings":"","what":"Calculating likelihood ratios (\\(LR\\)’s)","title":"Introduction","text":"errors matching genotypes: errors non-matching genotypes: Errors possible matching genotypes: Errors possible non-matching genotypes:","code":"LR_contribs <- wgsLR::calc_LRs(xs = c(0, 0),                                 xd = c(0, 0),                                 w = 0,                                 p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 16 LR_contribs <- wgsLR::calc_LRs(xs = c(0, 0),                                 xd = c(1, 0),                                 w = 0,                                 p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 0 LR_contribs <- wgsLR::calc_LRs(xs = c(0, 0),                                 xd = c(0, 0),                                 w = 0.001,                                 p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 15.936 LR_contribs <- wgsLR::calc_LRs(xs = c(0, 0),                                 xd = c(1, 0),                                 w = 0.001,                                 p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 0.04761785"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Mikkel Meyer Andersen. Author, maintainer, copyright holder. Poul Svante Eriksen. Author, copyright holder.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Andersen M, Eriksen P (2024). wgsLR: Whole-genome sequencing genotype error estimation forensic likelihood ratios accounting errors. R package version 0.0.1, https://github.com/mikldk/wgsLR.","code":"@Manual{,   title = {wgsLR: Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors},   author = {Mikkel Meyer Andersen and Poul Svante Eriksen},   year = {2024},   note = {R package version 0.0.1},   url = {https://github.com/mikldk/wgsLR}, }"},{"path":"/index.html","id":"wgslr-shotgun-sequencing-for-human-identification-dynamic-snp-marker-sets-and-likelihood-ratio-calculations-accounting-for-errors","dir":"","previous_headings":"","what":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"Please refer online documentation https://mikldk.github.io/wgsLR, including vignettes.","code":""},{"path":[]},{"path":"/index.html","id":"estimating-the-genotype-error-probability-w","dir":"","previous_headings":"A few small examples","what":"Estimating the genotype error probability, w","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"","code":"cases <- wgsLR::sample_data_Hp(n = 1000, w = 0.1, p = c(0.25, 0.25, 0.5)) tab <- table(cases$X_D, cases$X_S) tab ##     ##       0   1   2 ##   0 249  60   7 ##   1  67 122  87 ##   2   7  81 320 w_mle <- wgsLR::estimate_w(tab) w_mle ## [1] 0.09822341"},{"path":"/index.html","id":"calculating-likelihood-ratios-lrs","dir":"","previous_headings":"A few small examples","what":"Calculating likelihood ratios (LR’s)","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"Errors possible non-matching genotypes:","code":"LR_contribs <- wgsLR::calc_LRs(xs = c(0, 0, 2, 2),                                 xd = c(1, 0, 2, 2),                                 w = 0.001,                                 p = c(0.25, 0.25, 0.5)) LR_contribs ## [1] 0.01192834 3.99199202 1.99799850 1.99799850 prod(LR_contribs) ## [1] 0.1900904"},{"path":"/reference/add_errors_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hp-errors to table — add_errors_Hd","title":"Add Hp-errors to table — add_errors_Hd","text":"Add Hp-errors table","code":""},{"path":"/reference/add_errors_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hp-errors to table — add_errors_Hd","text":"","code":"add_errors_Hd(tab, w)"},{"path":"/reference/add_errors_Hd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hp-errors to table — add_errors_Hd","text":"tab table add errors w error probability","code":""},{"path":"/reference/add_errors_Hd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hp-errors to table — add_errors_Hd","text":"","code":"Z_D <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) Z_S <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z_D), to012(Z_S)) tab #>     #>       0   1   2 #>   0 158  45 183 #>   1  51  22  61 #>   2 157  62 261 new_tab <- add_errors_Hd(tab, w = 0.15) new_tab #>      [,1] [,2] [,3] #> [1,]   88  107  111 #> [2,]   92  108  119 #> [3,]   96  122  157 estimate_w(new_tab) # wrong! #> [1] 0.5 Z <- sample_profiles_without_error(n = 10000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z), to012(Z)) tab #>     #>        0    1    2 #>   0 3838    0    0 #>   1    0 1208    0 #>   2    0    0 4954 new_tab <- add_errors_Hd(tab, w = 0.25) new_tab #>      [,1] [,2] [,3] #> [1,] 1241 1079  402 #> [2,] 1079 1662 1343 #> [3,]  321 1245 1628 estimate_w(new_tab) # ok #> [1] 0.2576895"},{"path":"/reference/add_errors_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hp-errors to table — add_errors_Hp","title":"Add Hp-errors to table — add_errors_Hp","text":"Add Hp-errors table","code":""},{"path":"/reference/add_errors_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hp-errors to table — add_errors_Hp","text":"","code":"add_errors_Hp(tab, w)"},{"path":"/reference/add_errors_Hp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hp-errors to table — add_errors_Hp","text":"tab table add errors w error probability","code":""},{"path":"/reference/add_errors_Hp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hp-errors to table — add_errors_Hp","text":"","code":"Z <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z)) tab #>  #>   0   1   2  #> 359 137 504  new_tab <- add_errors_Hp(tab, w = 0.15) new_tab #>      [,1] [,2] [,3] #> [1,]  201   73   16 #> [2,]   69  148  102 #> [3,]   10  119  262 estimate_w(new_tab) #> [1] 0.1360233"},{"path":"/reference/add_errors_to_genotypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Add errors to genotypes — add_errors_to_genotypes","title":"Add errors to genotypes — add_errors_to_genotypes","text":"Add errors genotypes","code":""},{"path":"/reference/add_errors_to_genotypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add errors to genotypes — add_errors_to_genotypes","text":"","code":"add_errors_to_genotypes(Z, w)"},{"path":"/reference/add_errors_to_genotypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add errors to genotypes — add_errors_to_genotypes","text":"Z genotypes, e.g. created sample_profiles_without_error() w error probability","code":""},{"path":"/reference/add_errors_to_genotypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add errors to genotypes — add_errors_to_genotypes","text":"list, element locus matrix n rows two columns","code":""},{"path":"/reference/add_errors_to_genotypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add errors to genotypes — add_errors_to_genotypes","text":"","code":"Z <- sample_profiles_without_error(n = 5, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) to012(Z) #>      [,1] [,2] #> [1,]    2    2 #> [2,]    2    1 #> [3,]    0    1 #> [4,]    0    0 #> [5,]    0    0 X <- add_errors_to_genotypes(Z, 0.5) X #> [[1]] #>      [,1] [,2] #> [1,]    0    0 #> [2,]    1    0 #> [3,]    0    0 #> [4,]    1    0 #> [5,]    0    1 #>  #> [[2]] #>      [,1] [,2] #> [1,]    1    1 #> [2,]    0    0 #> [3,]    1    0 #> [4,]    1    0 #> [5,]    1    0 #>  to012(Z) - to012(add_errors_to_genotypes(Z, 0.0)) #>      [,1] [,2] #> [1,]    0    0 #> [2,]    0    0 #> [3,]    0    0 #> [4,]    0    0 #> [5,]    0    0   Z <- sample_profiles_without_error(n = 1000, p = c(0.5, 0.4, 0.1)) X1 <- add_errors_to_genotypes(Z, 0.5) X2 <- add_errors_to_genotypes(Z, 0.5) tab <- table(to012(X1), to012(X2)) tab #>     #>       0   1   2 #>   0  63 148  54 #>   1 120 253 121 #>   2  64 117  60 estimate_w(tab) #> [1] 0.4267082"},{"path":"/reference/allele_probs_to_geno_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","title":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","text":"Allele probabilities genotype probabilities assuming Hardy-Weinberg equilibrium","code":""},{"path":"/reference/allele_probs_to_geno_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","text":"","code":"allele_probs_to_geno_probs(x)"},{"path":"/reference/allele_probs_to_geno_probs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","text":"","code":"allele_probs_to_geno_probs(c(0.1, 0.2)) #> [[1]] #> [1] 0.01 0.18 0.81 #>  #> [[2]] #> [1] 0.04 0.32 0.64 #>"},{"path":"/reference/calc_LRs.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile — calc_LRs","title":"Calculate LR for a profile — calc_LRs","text":"Calculate LR profile","code":""},{"path":"/reference/calc_LRs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile — calc_LRs","text":"","code":"calc_LRs(xs, xd, w, p)"},{"path":"/reference/calc_LRs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile — calc_LRs","text":"xs profile suspect (0, 1, 2) xd profile case (0, 1, 2) w error probability p list genotype probabilities (length xd/xs, vector length 3 reuse)","code":""},{"path":"/reference/calc_LRs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile — calc_LRs","text":"","code":"calc_LRs(c(0, 0), c(0, 0), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 4 calc_LRs(c(0, 0), c(0, 0), w = 0, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> [1]  4 10    calc_LRs(c(0, 0), c(0, 1), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 0 calc_LRs(c(0, 0), c(0, 1), w = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.9999199992 0.0001199928 calc_LRs(c(0, 0), c(0, 1), w = 1e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.99199202 0.01192834"},{"path":"/reference/d_formulas_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hd — d_formulas_Hd","title":"Enumeration of possibilities under Hd — d_formulas_Hd","text":"Enumeration possibilities Hd","code":""},{"path":"/reference/d_formulas_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hd — d_formulas_Hd","text":"","code":"d_formulas_Hd"},{"path":"/reference/d_formulas_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hd — d_formulas_Hd","text":"object class tbl_df (inherits tbl, data.frame) 256 rows 20 columns.","code":""},{"path":"/reference/d_formulas_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hp — d_formulas_Hp","title":"Enumeration of possibilities under Hp — d_formulas_Hp","text":"Enumeration possibilities Hp","code":""},{"path":"/reference/d_formulas_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hp — d_formulas_Hp","text":"","code":"d_formulas_Hp"},{"path":"/reference/d_formulas_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hp — d_formulas_Hp","text":"object class tbl_df (inherits tbl, data.frame) 64 rows 16 columns.","code":""},{"path":"/reference/d_formulas_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities for single observation — d_formulas_single","title":"Enumeration of possibilities for single observation — d_formulas_single","text":"Enumeration possibilities single observation","code":""},{"path":"/reference/d_formulas_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities for single observation — d_formulas_single","text":"","code":"d_formulas_single"},{"path":"/reference/d_formulas_single.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities for single observation — d_formulas_single","text":"object class tbl_df (inherits tbl, data.frame) 16 rows 11 columns.","code":""},{"path":"/reference/d_prob_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hd grouped by XD and XS — d_prob_Hd","title":"Formulas under Hd grouped by XD and XS — d_prob_Hd","text":"Formulas Hd grouped XD XS","code":""},{"path":"/reference/d_prob_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hd grouped by XD and XS — d_prob_Hd","text":"","code":"d_prob_Hd"},{"path":"/reference/d_prob_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hd grouped by XD and XS — d_prob_Hd","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hp grouped by XD and XS — d_prob_Hp","title":"Formulas under Hp grouped by XD and XS — d_prob_Hp","text":"Formulas Hp grouped XD XS","code":""},{"path":"/reference/d_prob_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hp grouped by XD and XS — d_prob_Hp","text":"","code":"d_prob_Hp"},{"path":"/reference/d_prob_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hp grouped by XD and XS — d_prob_Hp","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_LR.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas for LR grouped by XD and XS — d_prob_LR","title":"Formulas for LR grouped by XD and XS — d_prob_LR","text":"Formulas LR grouped XD XS","code":""},{"path":"/reference/d_prob_LR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas for LR grouped by XD and XS — d_prob_LR","text":"","code":"d_prob_LR"},{"path":"/reference/d_prob_LR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas for LR grouped by XD and XS — d_prob_LR","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_probtable_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hd — d_probtable_Hd","title":"Probabilties for efficient sampling under Hd — d_probtable_Hd","text":"Probabilties efficient sampling Hd","code":""},{"path":"/reference/d_probtable_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hd — d_probtable_Hd","text":"","code":"d_probtable_Hd"},{"path":"/reference/d_probtable_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hd — d_probtable_Hd","text":"object class data.frame 256 rows 13 columns.","code":""},{"path":"/reference/d_probtable_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hp — d_probtable_Hp","title":"Probabilties for efficient sampling under Hp — d_probtable_Hp","text":"Probabilties efficient sampling Hp","code":""},{"path":"/reference/d_probtable_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hp — d_probtable_Hp","text":"","code":"d_probtable_Hp"},{"path":"/reference/d_probtable_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hp — d_probtable_Hp","text":"object class data.frame 64 rows 9 columns.","code":""},{"path":"/reference/estimate_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate error probability, w — estimate_w","title":"Estimate error probability, w — estimate_w","text":"Note tol = .Machine$double.eps unless overwritten.","code":""},{"path":"/reference/estimate_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate error probability, w — estimate_w","text":"","code":"estimate_w(x, use_mpfr = FALSE, ...)"},{"path":"/reference/estimate_w.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate error probability, w — estimate_w","text":"x either 3x3 contingency table 3-vector counts (n1, n2, n3) n1 = sum(diag(x)), n2 = x[1L, 3L] + x[3L, 1L], n3 = sum(x) - n1 - n2 use_mpfr whether use Rmpfr::optimizeR()] arbitrary precision ... passed optimise() Rmpfr::optimizeR use_mpfr = TRUE","code":""},{"path":"/reference/estimate_w.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate error probability, w — estimate_w","text":"","code":"tab1 <- matrix(c(1000, 10, 2, 12, 100, 8, 1, 7, 200), nrow = 3) tab1 #>      [,1] [,2] [,3] #> [1,] 1000   12    1 #> [2,]   10  100    7 #> [3,]    2    8  200 estimate_w(tab1) #> [1] 0.00815444 n1 <- sum(diag(tab1)) n2 <- tab1[1L, 3L] + tab1[3L, 1L] n3 <- sum(tab1) - n1 - n2 estimate_w(c(n1, n2, n3)) #> [1] 0.00815444  tab2 <- structure(c(40000L, 30L, 5L, 15L, 400L, 2L, 5L, 5L, 350L),         dim = c(3L, 3L), class = \"table\") tab2 #>      [,1]  [,2]  [,3]  #> [1,] 40000    15     5 #> [2,]    30   400     5 #> [3,]     5     2   350 estimate_w(tab2) #> [1] 0.0004414364 estimate_w(tab2, use_mpfr = TRUE) #>  #> Attaching package: ‘gmp’ #> The following objects are masked from ‘package:base’: #>  #>     %*%, apply, crossprod, matrix, tcrossprod #> C code of R package 'Rmpfr': GMP using 64 bits per limb #>  #> Attaching package: ‘Rmpfr’ #> The following object is masked from ‘package:gmp’: #>  #>     outer #> The following objects are masked from ‘package:stats’: #>  #>     dbinom, dgamma, dnbinom, dnorm, dpois, dt, pnorm #> The following objects are masked from ‘package:base’: #>  #>     cbind, pmax, pmin, rbind #> 1 'mpfr' number of precision  132   bits  #> [1] 0.00044143635878284077344503195816008828107627"},{"path":"/reference/estimate_w_bayesian.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"Beta prior assumed. Note $w$ assumed $< 0.5$.","code":""},{"path":"/reference/estimate_w_bayesian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"","code":"estimate_w_bayesian(   x,   prior_a = 1,   prior_b = 1,   chains = 4,   chains_function = lapply,   warmup = 1000,   iterations = 10000,   ... )"},{"path":"/reference/estimate_w_bayesian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"x either 3x3 contingency table 3-vector counts (n1, n2, n3) n1 = sum(diag(x)), n2 = x[1L, 3L] + x[3L, 1L], n3 = sum(x) - n1 - n2 prior_a First shape parameter prior beta distribution prior_b Second shape parameter prior beta distribution iterations Number iterations ... used","code":""},{"path":"/reference/estimate_w_bayesian.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"NOTE: recommend using e.g. cmdstanr, see vignette. just implementation demonstrate Bayesian approach.","code":""},{"path":"/reference/estimate_w_bayesian.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"","code":"tab1 <- matrix(c(1000, 10, 2, 12, 100, 8, 1, 7, 200), nrow = 3) tab1 #>      [,1] [,2] [,3] #> [1,] 1000   12    1 #> [2,]   10  100    7 #> [3,]    2    8  200 estimate_w(tab1) #> [1] 0.00815444 y <- estimate_w_bayesian(tab1); q <- lapply(y, \\(x) x$samples) |> unlist() mean(q); #plot(q, type = \"l\"); hist(q) #> [1] 0.008434311 sapply(y, \\(x) x$acceptance_ratio) #> [1] 0.2188 0.2269 0.2184 0.2282  estimate_w_bayesian(c(750, 0, 0), chains = 1, warmup = 0, iterations = 500) |>     lapply(\\(x) x$samples) |> unlist() |> plot(type = \"l\")   estimate_w(c(750, 0, 0)) #> [1] 9.733533e-17 y <- estimate_w_bayesian(c(750, 0, 0)); q <- lapply(y, \\(x) x$samples) |> unlist() mean(q); #plot(q, type = \"l\"); hist(q) #> [1] 0.0003492366 sapply(y, \\(x) x$acceptance_ratio) #> [1] 0.0636 0.0673 0.0695 0.0659"},{"path":"/reference/estimate_w_se.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate standard error of error probability, w — estimate_w_se","title":"Estimate standard error of error probability, w — estimate_w_se","text":"Note relies Hessian approximation returned numDeriv::hessian().","code":""},{"path":"/reference/estimate_w_se.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate standard error of error probability, w — estimate_w_se","text":"","code":"estimate_w_se(x, w, method.args = list())"},{"path":"/reference/estimate_w_se.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate standard error of error probability, w — estimate_w_se","text":"w estimated error probability w method.args see numDeriv::grad()","code":""},{"path":"/reference/estimate_w_se.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate standard error of error probability, w — estimate_w_se","text":"","code":"x <- matrix(c(1000, 10, 2, 12, 100, 8, 1, 7, 200), nrow = 3) x #>      [,1] [,2] [,3] #> [1,] 1000   12    1 #> [2,]   10  100    7 #> [3,]    2    8  200 w <- estimate_w(x) w #> [1] 0.00815444 estimate_w_se(x, w) #> [1] 0.001248947"},{"path":"/reference/extract_profile.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract profile from ranked markers — extract_profile","title":"Extract profile from ranked markers — extract_profile","text":"Uses recent marker ranking (see function argument).","code":""},{"path":"/reference/extract_profile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract profile from ranked markers — extract_profile","text":"","code":"extract_profile(x, markers = marker_candidates_v1)"},{"path":"/reference/extract_profile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract profile from ranked markers — extract_profile","text":"x Data (potentially already filtered), including columns chr pos markers Marker ranking","code":""},{"path":"/reference/extract_profile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract profile from ranked markers — extract_profile","text":"Original data extra columns segment, segment_no rank","code":""},{"path":"/reference/extract_profile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract profile from ranked markers — extract_profile","text":"NOTE: check reference alternative alleles . See examples one way inspect .","code":""},{"path":"/reference/extract_profile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract profile from ranked markers — extract_profile","text":"","code":"vcf <- vcf_example_data_v1 |> rename(chr = CHROM, pos = POS) #> Error in rename(vcf_example_data_v1, chr = CHROM, pos = POS): could not find function \"rename\" prof <- extract_profile(vcf) #> Error in dplyr::inner_join(x, marker_cand, by = c(\"chr\", \"pos\")): object 'vcf' not found head(prof) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof' not found nrow(prof) #> Error in nrow(prof): object 'prof' not found table(prof$rank) #> Error in table(prof$rank): object 'prof' not found  # Also using allele frequencies from `marker_candidates_v1` prof_extra_info <- prof |> inner_join(marker_candidates_v1 |>    select(chr, pos, ref, alt, AF_afr, AF_eas, AF_nfe), by = c(\"chr\", \"pos\")) #> Error in inner_join(prof, select(marker_candidates_v1, chr, pos, ref,     alt, AF_afr, AF_eas, AF_nfe), by = c(\"chr\", \"pos\")): could not find function \"inner_join\" head(prof_extra_info) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof_extra_info' not found  subset(prof_extra_info, ref != REF) #> Error in subset(prof_extra_info, ref != REF): object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT) #> Error in subset(prof_extra_info, alt != ALT): object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT & ALT != \"?\") #> Error in subset(prof_extra_info, alt != ALT & ALT != \"?\"): object 'prof_extra_info' not found  X <- to012(prof_extra_info$GT) #> Error in to012(prof_extra_info$GT): object 'prof_extra_info' not found X #> Error in eval(expr, envir, enclos): object 'X' not found genoprob <- allele_probs_to_geno_probs(prof_extra_info$AF_nfe) #> Error in lapply(x, function(q) {    c(q^2, 2 * q * (1 - q), (1 - q)^2)}): object 'prof_extra_info' not found  LRs <- calc_LRs(xs = X, xd = X, w = 0.01, p = genoprob) #> Error in stopifnot(length(x) >= 1L): object 'X' not found WoE <- sum(log10(LRs)) #> Error in eval(expr, envir, enclos): object 'LRs' not found WoE #> Error in eval(expr, envir, enclos): object 'WoE' not found  ws <- 10^(-(6:1)) LRs_ws <- sapply(ws, \\(w) sum(log10(calc_LRs(xs = X, xd = X, w = w, p = genoprob)))) #> Error in stopifnot(length(x) >= 1L): object 'X' not found cbind(ws, LRs_ws) #> Error in eval(quote(list(...)), env): object 'LRs_ws' not found  # Assume two errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found Xd <- X #> Error in eval(expr, envir, enclos): object 'X' not found Xd[1] <- 1 #> Error in Xd[1] <- 1: object 'Xd' not found Xd[2] <- 1 #> Error in Xd[2] <- 1: object 'Xd' not found LRs_ws_Xd <- sapply(ws, \\(w) sum(log10(calc_LRs(xs = X, xd = Xd, w = w, p = genoprob)))) #> Error in stopifnot(length(x) >= 1L): object 'X' not found cbind(ws, LRs_ws_Xd) #> Error in eval(quote(list(...)), env): object 'LRs_ws_Xd' not found  # Assume two more errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found Xd[3] <- 0 #> Error in Xd[3] <- 0: object 'Xd' not found Xd[4] <- 0 #> Error in Xd[4] <- 0: object 'Xd' not found LRs_ws_Xd4 <- sapply(ws, \\(w) sum(log10(calc_LRs(xs = X, xd = Xd, w = w, p = genoprob)))) #> Error in stopifnot(length(x) >= 1L): object 'X' not found cbind(ws, LRs_ws_Xd4) #> Error in eval(quote(list(...)), env): object 'LRs_ws_Xd4' not found"},{"path":"/reference/extract_profile_v1.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract profile — extract_profile_v1","title":"Extract profile — extract_profile_v1","text":"Uses marker_candidates_v1 ranking.","code":""},{"path":"/reference/extract_profile_v1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract profile — extract_profile_v1","text":"","code":"extract_profile_v1(x)"},{"path":"/reference/extract_profile_v1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract profile — extract_profile_v1","text":"x Data (potentially already filtered), including columns chr pos","code":""},{"path":"/reference/extract_profile_v1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract profile — extract_profile_v1","text":"","code":"vcf <- vcf_example_data_v1 |> rename(chr = CHROM, pos = POS) #> Error in rename(vcf_example_data_v1, chr = CHROM, pos = POS): could not find function \"rename\" prof <- extract_profile(vcf) #> Error in dplyr::inner_join(x, marker_cand, by = c(\"chr\", \"pos\")): object 'vcf' not found head(prof) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof' not found nrow(prof) #> Error in nrow(prof): object 'prof' not found table(prof$rank) #> Error in table(prof$rank): object 'prof' not found  # Also using allele frequencies from `marker_candidates_v1` prof_extra_info <- prof |> inner_join(marker_candidates_v1 |>    select(chr, pos, ref, alt, AF_afr, AF_eas, AF_nfe), by = c(\"chr\", \"pos\")) #> Error in inner_join(prof, select(marker_candidates_v1, chr, pos, ref,     alt, AF_afr, AF_eas, AF_nfe), by = c(\"chr\", \"pos\")): could not find function \"inner_join\" head(prof_extra_info) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof_extra_info' not found  subset(prof_extra_info, ref != REF) #> Error in subset(prof_extra_info, ref != REF): object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT) #> Error in subset(prof_extra_info, alt != ALT): object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT & ALT != \"?\") #> Error in subset(prof_extra_info, alt != ALT & ALT != \"?\"): object 'prof_extra_info' not found  X <- to012(prof_extra_info$GT) #> Error in to012(prof_extra_info$GT): object 'prof_extra_info' not found X #> Error in eval(expr, envir, enclos): object 'X' not found genoprob <- allele_probs_to_geno_probs(prof_extra_info$AF_nfe) #> Error in lapply(x, function(q) {    c(q^2, 2 * q * (1 - q), (1 - q)^2)}): object 'prof_extra_info' not found  LRs <- calc_LRs(xs = X, xd = X, w = 0.01, p = genoprob) #> Error in stopifnot(length(x) >= 1L): object 'X' not found WoE <- sum(log10(LRs)) #> Error in eval(expr, envir, enclos): object 'LRs' not found WoE #> Error in eval(expr, envir, enclos): object 'WoE' not found  ws <- 10^(-(6:1)) LRs_ws <- sapply(ws, \\(w) sum(log10(calc_LRs(xs = X, xd = X, w = w, p = genoprob)))) #> Error in stopifnot(length(x) >= 1L): object 'X' not found cbind(ws, LRs_ws) #> Error in eval(quote(list(...)), env): object 'LRs_ws' not found  # Assume two errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found Xd <- X #> Error in eval(expr, envir, enclos): object 'X' not found Xd[1] <- 1 #> Error in Xd[1] <- 1: object 'Xd' not found Xd[2] <- 1 #> Error in Xd[2] <- 1: object 'Xd' not found LRs_ws_Xd <- sapply(ws, \\(w) sum(log10(calc_LRs(xs = X, xd = Xd, w = w, p = genoprob)))) #> Error in stopifnot(length(x) >= 1L): object 'X' not found cbind(ws, LRs_ws_Xd) #> Error in eval(quote(list(...)), env): object 'LRs_ws_Xd' not found  # Assume two more errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found Xd[3] <- 0 #> Error in Xd[3] <- 0: object 'Xd' not found Xd[4] <- 0 #> Error in Xd[4] <- 0: object 'Xd' not found LRs_ws_Xd4 <- sapply(ws, \\(w) sum(log10(calc_LRs(xs = X, xd = Xd, w = w, p = genoprob)))) #> Error in stopifnot(length(x) >= 1L): object 'X' not found cbind(ws, LRs_ws_Xd4) #> Error in eval(quote(list(...)), env): object 'LRs_ws_Xd4' not found"},{"path":"/reference/get_ns.html","id":null,"dir":"Reference","previous_headings":"","what":"Get counts from table — get_ns","title":"Get counts from table — get_ns","text":"Get counts table","code":""},{"path":"/reference/get_ns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get counts from table — get_ns","text":"","code":"get_ns(x)"},{"path":"/reference/graph_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hd — graph_Hd","title":"Graph for enumeration of possibilities under Hd — graph_Hd","text":"Graph enumeration possibilities Hd","code":""},{"path":"/reference/graph_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hd — graph_Hd","text":"","code":"graph_Hd"},{"path":"/reference/graph_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hd — graph_Hd","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hp — graph_Hp","title":"Graph for enumeration of possibilities under Hp — graph_Hp","text":"Graph enumeration possibilities Hp","code":""},{"path":"/reference/graph_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hp — graph_Hp","text":"","code":"graph_Hp"},{"path":"/reference/graph_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hp — graph_Hp","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities for single observation — graph_single","title":"Graph for enumeration of possibilities for single observation — graph_single","text":"Graph enumeration possibilities single observation","code":""},{"path":"/reference/graph_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities for single observation — graph_single","text":"","code":"graph_single"},{"path":"/reference/graph_single.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities for single observation — graph_single","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/marker_candidates_v1.html","id":null,"dir":"Reference","previous_headings":"","what":"Marker candidates (v1) — marker_candidates_v1","title":"Marker candidates (v1) — marker_candidates_v1","text":"Marker candidates (v1)","code":""},{"path":"/reference/marker_candidates_v1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marker candidates (v1) — marker_candidates_v1","text":"","code":"marker_candidates_v1"},{"path":"/reference/marker_candidates_v1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Marker candidates (v1) — marker_candidates_v1","text":"object class tbl_df (inherits tbl, data.frame) 4128 rows 23 columns.","code":""},{"path":"/reference/marker_candidates_v1.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Marker candidates (v1) — marker_candidates_v1","text":"https://gnomad.broadinstitute.org/","code":""},{"path":"/reference/reuse_genotype_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Re-use genotype probabilities — reuse_genotype_probs","title":"Re-use genotype probabilities — reuse_genotype_probs","text":"p <- c(0.2, 0.7, 0.1) to012(sample_profiles_without_error(n = 2, p = p))","code":""},{"path":"/reference/reuse_genotype_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Re-use genotype probabilities — reuse_genotype_probs","text":"","code":"reuse_genotype_probs(p, n)"},{"path":"/reference/reuse_genotype_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Re-use genotype probabilities — reuse_genotype_probs","text":"p_10loci <- reuse_genotype_probs(p, 10) to012(sample_profiles_without_error(n = 2, p = p_10loci))","code":""},{"path":"/reference/sample_data_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hd — sample_data_Hd","title":"Sample cases under Hd — sample_data_Hd","text":"One latent genotype, ZD, true donor (D) one latent genotype, ZS, suspect (S).","code":""},{"path":"/reference/sample_data_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hd — sample_data_Hd","text":"","code":"sample_data_Hd(n, w, p)"},{"path":"/reference/sample_data_Hd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hd — sample_data_Hd","text":"n number samples w error probability p list genotype probabilities (length number loci) vector length 3 single locus","code":""},{"path":"/reference/sample_data_Hd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hd — sample_data_Hd","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hd — sample_data_Hd","text":"","code":"sample_data_Hd(n = 10, w = 0.3, p = c(0.25, 0.25, 0.5)) #> $X_D #>       [,1] #>  [1,]    2 #>  [2,]    1 #>  [3,]    1 #>  [4,]    1 #>  [5,]    2 #>  [6,]    1 #>  [7,]    2 #>  [8,]    1 #>  [9,]    2 #> [10,]    0 #>  #> $X_S #>       [,1] #>  [1,]    1 #>  [2,]    1 #>  [3,]    2 #>  [4,]    1 #>  [5,]    1 #>  [6,]    1 #>  [7,]    1 #>  [8,]    1 #>  [9,]    2 #> [10,]    2 #>  sample_data_Hd(n = 10, w = 0.1, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $X_D #>       [,1] [,2] #>  [1,]    2    0 #>  [2,]    0    0 #>  [3,]    2    1 #>  [4,]    2    1 #>  [5,]    0    2 #>  [6,]    1    0 #>  [7,]    1    0 #>  [8,]    0    0 #>  [9,]    2    0 #> [10,]    0    0 #>  #> $X_S #>       [,1] [,2] #>  [1,]    2    1 #>  [2,]    0    0 #>  [3,]    0    1 #>  [4,]    0    1 #>  [5,]    1    1 #>  [6,]    1    1 #>  [7,]    1    0 #>  [8,]    1    1 #>  [9,]    0    0 #> [10,]    1    0 #>     cases <- sample_data_Hd(n = 1000, w = 0, p = c(0.25, 0.25, 0.5)) tab <- table(cases$X_D, cases$X_S) tab #>     #>       0   1   2 #>   0 141  47 174 #>   1  52  18  72 #>   2 193  65 238"},{"path":"/reference/sample_data_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hp — sample_data_Hp","title":"Sample cases under Hp — sample_data_Hp","text":"latent genotype, Z, independent errors true donor (D) suspect (S).","code":""},{"path":"/reference/sample_data_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hp — sample_data_Hp","text":"","code":"sample_data_Hp(n, w, p)"},{"path":"/reference/sample_data_Hp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hp — sample_data_Hp","text":"n number samples w error probability p list genotype probabilities (length number loci) vector length 3 single locus","code":""},{"path":"/reference/sample_data_Hp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hp — sample_data_Hp","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hp — sample_data_Hp","text":"","code":"sample_data_Hp(n = 10, w = 0.3, p = c(0.25, 0.25, 0.5)) #> $X_D #>       [,1] #>  [1,]    2 #>  [2,]    2 #>  [3,]    1 #>  [4,]    1 #>  [5,]    1 #>  [6,]    1 #>  [7,]    2 #>  [8,]    0 #>  [9,]    0 #> [10,]    1 #>  #> $X_S #>       [,1] #>  [1,]    2 #>  [2,]    2 #>  [3,]    1 #>  [4,]    1 #>  [5,]    1 #>  [6,]    2 #>  [7,]    2 #>  [8,]    0 #>  [9,]    0 #> [10,]    2 #>  sample_data_Hp(n = 10, w = 0.1, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $X_D #>       [,1] [,2] #>  [1,]    1    1 #>  [2,]    0    2 #>  [3,]    2    0 #>  [4,]    2    1 #>  [5,]    2    1 #>  [6,]    0    0 #>  [7,]    2    1 #>  [8,]    0    1 #>  [9,]    1    1 #> [10,]    1    1 #>  #> $X_S #>       [,1] [,2] #>  [1,]    1    2 #>  [2,]    0    2 #>  [3,]    2    0 #>  [4,]    2    1 #>  [5,]    1    1 #>  [6,]    0    0 #>  [7,]    2    1 #>  [8,]    0    1 #>  [9,]    0    1 #> [10,]    1    2 #>     cases <- sample_data_Hp(n = 1000, w = 0.3, p = c(0.25, 0.25, 0.5)) tab <- table(cases$X_D, cases$X_S) tab #>     #>       0   1   2 #>   0  94 105  46 #>   1 102 205 126 #>   2  47 143 132 estimate_w(tab) #> [1] 0.3015969"},{"path":"/reference/sample_profiles_without_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample genotype without error — sample_profiles_without_error","title":"Sample genotype without error — sample_profiles_without_error","text":"Sample genotype without error","code":""},{"path":"/reference/sample_profiles_without_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample genotype without error — sample_profiles_without_error","text":"","code":"sample_profiles_without_error(n, p)"},{"path":"/reference/sample_profiles_without_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample genotype without error — sample_profiles_without_error","text":"n number samples p list genotype probabilities vector length 3 single locus","code":""},{"path":"/reference/sample_profiles_without_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample genotype without error — sample_profiles_without_error","text":"list, element locus matrix n rows two columns","code":""},{"path":"/reference/sample_profiles_without_error.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample genotype without error — sample_profiles_without_error","text":"","code":"Z <- sample_profiles_without_error(n = 2, p = c(0.25, 0.25, 0.5)) to012(Z) #>      [,1] #> [1,]    2 #> [2,]    0 Z <- sample_profiles_without_error(n = 5, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) Z #> [[1]] #>      [,1] [,2] #> [1,]    1    1 #> [2,]    0    0 #> [3,]    1    1 #> [4,]    0    0 #> [5,]    0    0 #>  #> [[2]] #>      [,1] [,2] #> [1,]    0    0 #> [2,]    1    0 #> [3,]    0    0 #> [4,]    1    0 #> [5,]    1    1 #>  to012(Z) #>      [,1] [,2] #> [1,]    2    0 #> [2,]    0    1 #> [3,]    2    0 #> [4,]    0    1 #> [5,]    0    2"},{"path":"/reference/to012.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert to 0/1/2 notation — to012","title":"Convert to 0/1/2 notation — to012","text":"Can Convert character genotype 0/0, 0/1, 1/0, 1/1 0, 1, 2 notation. Convert haplotypes c(0, 0), c(0, 1), c(1, 0), c(1, 1) 0, 1, 2 notation.","code":""},{"path":"/reference/to012.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert to 0/1/2 notation — to012","text":"","code":"to012(x)"},{"path":"/reference/to012.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert to 0/1/2 notation — to012","text":"x genotypes, e.g. sample_profiles_without_error()","code":""},{"path":"/reference/to012.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert to 0/1/2 notation — to012","text":"Note input list loci, element matrix n x 2 n number individuals. Output n x loci matrix.","code":""},{"path":"/reference/to012.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert to 0/1/2 notation — to012","text":"","code":"to012(c(\"0/0\", \"0/1\", \"1/0\", \"1/1\")) #> [1] 0 1 1 2  Z <- sample_profiles_without_error(n = 10, p = list(   c(0.25, 0.25, 0.5), c(0.01, 0.01, 0.98))) Z #> [[1]] #>       [,1] [,2] #>  [1,]    1    1 #>  [2,]    0    0 #>  [3,]    1    0 #>  [4,]    0    0 #>  [5,]    1    1 #>  [6,]    0    0 #>  [7,]    0    0 #>  [8,]    1    1 #>  [9,]    0    0 #> [10,]    0    0 #>  #> [[2]] #>       [,1] [,2] #>  [1,]    1    1 #>  [2,]    1    1 #>  [3,]    1    1 #>  [4,]    1    1 #>  [5,]    1    1 #>  [6,]    1    1 #>  [7,]    1    1 #>  [8,]    1    1 #>  [9,]    1    1 #> [10,]    0    0 #>  to012(Z) #>       [,1] [,2] #>  [1,]    2    2 #>  [2,]    0    2 #>  [3,]    1    2 #>  [4,]    0    2 #>  [5,]    2    2 #>  [6,]    0    2 #>  [7,]    0    2 #>  [8,]    2    2 #>  [9,]    0    2 #> [10,]    0    0"}]
